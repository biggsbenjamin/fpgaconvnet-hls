{
  "partition": [
    {
      "id": 0,
      "ports": 1,
      "batch_size": 1,
      "input_node": "lenet_in",
      "output_node": "lenet_out",
      "weights_reloading_factor": 1,
      "weights_reloading_layer": "lenet_out",
      "layers": [
        {
          "name": "4",
          "streams_in": [
            {
              "name": "in",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "CONVOLUTION4_POOLING5",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "CONVOLUTION",
          "weights_path": "first_exit.0.weight",
          "bias_path": "",
          "parameters": {
            "rows_in": 28,
            "cols_in": 28,
            "channels_in": 1,
            "rows_out": 32,
            "cols_out": 32,
            "channels_out": 5,
            "coarse_in": 1,
            "coarse_out": 1,
            "filters": 5,
            "pad": 4,
            "pad_top": 4,
            "pad_right": 4,
            "pad_bottom": 4,
            "pad_left": 4,
            "stride": 1,
            "groups": 1,
            "kernel_size": 5,
            "fine": 1,
            "buffer_depth": 0,
            "batch_size": 1
          },
          "node_in": [
            "CONVOLUTION4"
          ],
          "node_out": [
            "POOLING5"
          ]
        },
        {
          "name": "5",
          "streams_in": [
            {
              "name": "CONVOLUTION4_POOLING5",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "POOLING5_RELU6",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "POOLING",
          "parameters": {
            "rows_in": 32,
            "cols_in": 32,
            "channels_in": 5,
            "rows_out": 16,
            "cols_out": 16,
            "channels_out": 5,
            "coarse_in": 1,
            "coarse_out": 1,
            "pad": 0,
            "pad_top": 0,
            "pad_right": 0,
            "pad_bottom": 0,
            "pad_left": 0,
            "stride": 2,
            "kernel_size": 2,
            "buffer_depth": 0,
            "batch_size": 1,
            "coarse": 1
          },
          "node_in": [
            "CONVOLUTION4"
          ],
          "node_out": [
            "RELU6"
          ]
        },
        {
          "name": "6",
          "streams_in": [
            {
              "name": "POOLING5_RELU6",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "RELU6_CONVOLUTION7",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "RELU",
          "parameters": {
            "rows_in": 16,
            "cols_in": 16,
            "channels_in": 5,
            "rows_out": 16,
            "cols_out": 16,
            "channels_out": 5,
            "coarse_in": 1,
            "coarse_out": 1,
            "buffer_depth": 0,
            "batch_size": 1,
            "coarse": 1
          },
          "node_in": [
            "POOLING5"
          ],
          "node_out": [
            "CONVOLUTION7"
          ]
        },
        {
          "name": "7",
          "streams_in": [
            {
              "name": "RELU6_CONVOLUTION7",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "CONVOLUTION7_POOLING8",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "CONVOLUTION",
          "weights_path": "first_exit.3.weight",
          "bias_path": "",
          "parameters": {
            "rows_in": 16,
            "cols_in": 16,
            "channels_in": 5,
            "rows_out": 16,
            "cols_out": 16,
            "channels_out": 10,
            "coarse_in": 1,
            "coarse_out": 1,
            "filters": 10,
            "pad": 1,
            "pad_top": 1,
            "pad_right": 1,
            "pad_bottom": 1,
            "pad_left": 1,
            "stride": 1,
            "groups": 1,
            "kernel_size": 3,
            "fine": 1,
            "buffer_depth": 0,
            "batch_size": 1
          },
          "node_in": [
            "RELU6"
          ],
          "node_out": [
            "POOLING8"
          ]
        },
        {
          "name": "8",
          "streams_in": [
            {
              "name": "CONVOLUTION7_POOLING8",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "POOLING8_RELU9",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "POOLING",
          "parameters": {
            "rows_in": 16,
            "cols_in": 16,
            "channels_in": 10,
            "rows_out": 8,
            "cols_out": 8,
            "channels_out": 10,
            "coarse_in": 1,
            "coarse_out": 1,
            "pad": 0,
            "pad_top": 0,
            "pad_right": 0,
            "pad_bottom": 0,
            "pad_left": 0,
            "stride": 2,
            "kernel_size": 2,
            "buffer_depth": 0,
            "batch_size": 1,
            "coarse": 1
          },
          "node_in": [
            "CONVOLUTION7"
          ],
          "node_out": [
            "RELU9"
          ]
        },
        {
          "name": "9",
          "streams_in": [
            {
              "name": "POOLING8_RELU9",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "RELU9_lenet_out",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "RELU",
          "parameters": {
            "rows_in": 8,
            "cols_in": 8,
            "channels_in": 10,
            "rows_out": 8,
            "cols_out": 8,
            "channels_out": 10,
            "coarse_in": 1,
            "coarse_out": 1,
            "buffer_depth": 0,
            "batch_size": 1,
            "coarse": 1
          },
          "node_in": [
            "POOLING8"
          ],
          "node_out": [
            "lenet_out"
          ]
        },
        {
          "name": "lenet_out",
          "streams_in": [
            {
              "name": "RELU9_lenet_out",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "streams_out": [
            {
              "name": "out",
              "coarse": 1,
              "ctrl": false,
              "split": false
            }
          ],
          "type": "INNER_PRODUCT",
          "weights_path": "13",
          "bias_path": "",
          "parameters": {
            "rows_in": 8,
            "cols_in": 8,
            "channels_in": 10,
            "rows_out": 1,
            "cols_out": 1,
            "channels_out": 10,
            "coarse_in": 1,
            "coarse_out": 1,
            "filters": 10,
            "buffer_depth": 0,
            "batch_size": 1,
            "matmul_flag": true
          },
          "node_in": [
            "RELU9"
          ],
          "node_out": [
            "lenet_out"
          ]
        }
      ]
    }
  ]
}